{
  "priority": 1,
  "request": {
    "method": "POST",
    "urlPath": "/anthropic/v1/messages",
    "headers": {
      "x-api-key": {
        "contains": "anthropic-chat-debug"
      }
    },
    "bodyPatterns": [
      {
        "matchesJsonPath": "$.messages[-1:][?(@.content[0].text == 'lots of tool calls')]"
      }
    ]
  },
  "response": {
    "status": 200,
    "headers": {
      "Content-Type": "text/event-stream",
      "Cache-Control": "no-cache"
    },
    "chunkedDribbleDelay": {
      "numberOfChunks": 60,
      "totalDuration": 10000
    },
    "body": "event: message_start\ndata: {\"type\":\"message_start\",\"message\":{\"id\":\"msg_streaming_tools\",\"type\":\"message\",\"role\":\"assistant\",\"model\":\"claude-3-5-sonnet-20241022\",\"content\":[],\"stop_reason\":null,\"stop_sequence\":null,\"usage\":{\"input_tokens\":100,\"output_tokens\":0}}}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":0,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":0,\"delta\":{\"type\":\"text_delta\",\"text\":\"Let me gather some information for you.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":0}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":1,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_01\",\"name\":\"archestra__whoami\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":1,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":1}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":2,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":2,\"delta\":{\"type\":\"text_delta\",\"text\":\"Now let me check your account limits and quota information.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":2}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":3,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_02\",\"name\":\"archestra__get_limits\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":3,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":3}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":4,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":4,\"delta\":{\"type\":\"text_delta\",\"text\":\"I should also retrieve the list of MCP servers configured in your workspace.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":4}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":5,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_03\",\"name\":\"archestra__get_mcp_servers\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":5,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":5}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":6,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":6,\"delta\":{\"type\":\"text_delta\",\"text\":\"Let me also check what autonomy policy operators are available to you.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":6}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":7,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_04\",\"name\":\"archestra__get_autonomy_policy_operators\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":7,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":7}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":8,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":8,\"delta\":{\"type\":\"text_delta\",\"text\":\"I will now search the private MCP registry for any additional tools.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":8}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":9,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_05\",\"name\":\"archestra__search_private_mcp_registry\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":9,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":9}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":10,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":10,\"delta\":{\"type\":\"text_delta\",\"text\":\"Let me double-check your identity with another whoami call.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":10}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":11,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_06\",\"name\":\"archestra__whoami\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":11,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":11}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":12,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":12,\"delta\":{\"type\":\"text_delta\",\"text\":\"And verify the limits once more to ensure accuracy.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":12}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":13,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_07\",\"name\":\"archestra__get_limits\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":13,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":13}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":14,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":14,\"delta\":{\"type\":\"text_delta\",\"text\":\"Checking MCP servers again for any recent changes.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":14}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":15,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_08\",\"name\":\"archestra__get_mcp_servers\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":15,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":15}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":16,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":16,\"delta\":{\"type\":\"text_delta\",\"text\":\"Final check on autonomy policies.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":16}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":17,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_09\",\"name\":\"archestra__get_autonomy_policy_operators\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":17,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":17}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":18,\"content_block\":{\"type\":\"text\",\"text\":\"\"}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":18,\"delta\":{\"type\":\"text_delta\",\"text\":\"One more registry search to be thorough.\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":18}\n\nevent: content_block_start\ndata: {\"type\":\"content_block_start\",\"index\":19,\"content_block\":{\"type\":\"tool_use\",\"id\":\"toolu_10\",\"name\":\"archestra__search_private_mcp_registry\",\"input\":{}}}\n\nevent: content_block_delta\ndata: {\"type\":\"content_block_delta\",\"index\":19,\"delta\":{\"type\":\"input_json_delta\",\"partial_json\":\"{}\"}}\n\nevent: content_block_stop\ndata: {\"type\":\"content_block_stop\",\"index\":19}\n\nevent: message_delta\ndata: {\"type\":\"message_delta\",\"delta\":{\"stop_reason\":\"tool_use\",\"stop_sequence\":null},\"usage\":{\"output_tokens\":100}}\n\nevent: message_stop\ndata: {\"type\":\"message_stop\"}\n\n"
  }
}
